# HRD PT. BBAG

Aplikasi web modern untuk manajemen sumber daya manusia (HRD) dan data operasional untuk PT. Bahtera Berkah Abadi Grup.

## âœ¨ Fitur Utama

- **Dashboard Interaktif**: Visualisasi KPI utama dalam kartu metrik yang mudah dibaca.
- **Grafik Performa**: Grafik batang dan garis untuk membandingkan volume produksi harian dengan target.
- **Filter Data Dinamis**: Filter data berdasarkan rentang tanggal untuk analisis yang lebih spesifik.
- **Tabel Data Terkini**: Menampilkan log operasional terbaru langsung di dashboard.
- **Analisis Berbasis AI**: Memanfaatkan Google Gemini API untuk menghasilkan ringkasan, identifikasi masalah, dan rekomendasi strategis secara otomatis.
- **Backend Database**: Menggunakan **Supabase** untuk penyimpanan data yang persisten dan aman.
- **Panel Admin**:
  - Sistem login sederhana untuk akses ke manajemen data.
  - Input, edit, dan hapus data operasional harian melalui form.
  - **Manajemen Data Karyawan**: Tambah, lihat, edit, dan hapus data karyawan, termasuk URL foto.
  - **Manajemen Data Lanjutan**:
    - Cadangkan (backup) seluruh data operasional dan karyawan ke dalam satu file Excel.
    - Hapus semua data (operasional atau karyawan) secara permanen.
- **Desain Responsif**: Tampilan optimal di berbagai perangkat, dari desktop hingga mobile.

## ğŸš€ Teknologi yang Digunakan

- **Frontend**: React, TypeScript
- **Styling**: Tailwind CSS
- **Grafik**: Recharts
- **Backend (Database)**: Supabase
- **Manipulasi Excel**: SheetJS (xlsx)
- **AI & Generative AI**: Google Gemini API (`@google/genai`)
- **Build Tool**: Dijalankan langsung di browser menggunakan ES Modules dan Import Maps (tanpa proses build).

## ğŸ› ï¸ Panduan Memulai dan Deployment

Aplikasi ini dirancang untuk dijalankan langsung di browser dan dideploy dengan mudah ke platform hosting statis seperti Netlify.

### 1. Dapatkan Kredensial

Anda akan memerlukan tiga kunci untuk menjalankan aplikasi ini:
1.  **Google Gemini API Key**: Dapatkan dari [Google AI Studio](https://aistudio.google.com/app/apikey).
2.  **Supabase Project URL**: Dari dashboard proyek Supabase Anda.
3.  **Supabase Anon (Public) Key**: Dari dashboard proyek Supabase Anda.

### 2. Konfigurasi untuk Development Lokal

1.  Buka file `index.html`.
2.  Temukan blok `<script>` di dekat bagian bawah file.
3.  Di dalam objek `window.APP_ENV`, ganti nilai placeholder dengan kredensial yang Anda dapatkan di langkah 1.

    ```javascript
    window.APP_ENV = {
      API_KEY: "GANTI_DENGAN_KUNCI_API_GEMINI_ANDA",
      SUPABASE_URL: "GANTI_DENGAN_URL_SUPABASE_ANDA",
      SUPABASE_ANON_KEY: "GANTI_DENGAN_KUNCI_ANON_SUPABASE_ANDA"
    };
    ```
4.  Simpan file `index.html`, dan aplikasi siap dijalankan secara lokal.

### 3. Database Setup (Supabase)

1.  **Buat Proyek Baru**: Login ke [Supabase](https://supabase.com/) dan buat proyek baru.
2.  **Buka SQL Editor**: Buka **SQL Editor** di dashboard Supabase Anda. Salin dan jalankan skrip SQL **tunggal** di bawah ini untuk membuat atau memperbarui semua tabel dan kebijakan keamanan yang diperlukan. Skrip ini aman untuk dijalankan beberapa kali.

```sql
-- =================================================================
-- SKRIP SQL LENGKAP UNTUK APLIKASI HRD PT. BBAG
-- =================================================================
-- Skrip ini akan membuat tabel `operational_data` dan `karyawan`
-- serta mengkonfigurasi Row Level Security (RLS) yang diperlukan.
-- Aman untuk dijalankan kembali karena menggunakan `IF NOT EXISTS`.
-- =================================================================

-- -----------------------------------------------------------------
-- Tabel 1: operational_data
-- Menyimpan semua data log operasional harian.
-- -----------------------------------------------------------------

-- Membuat tabel jika belum ada
CREATE TABLE IF NOT EXISTS public.operational_data (
  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,
  date DATE NOT NULL UNIQUE,
  pro NUMERIC DEFAULT 0,
  stb NUMERIC DEFAULT 0,
  bd NUMERIC DEFAULT 0,
  wt NUMERIC DEFAULT 0,
  pa NUMERIC DEFAULT 0,
  ua NUMERIC DEFAULT 0,
  ma NUMERIC DEFAULT 0,
  eu NUMERIC DEFAULT 0,
  ritase INTEGER DEFAULT 0,
  volume NUMERIC DEFAULT 0,
  "averageM3" NUMERIC DEFAULT 0,
  "targetM3" NUMERIC DEFAULT 0,
  pencapaian NUMERIC DEFAULT 0
);

-- Mengaktifkan Row Level Security (RLS) untuk keamanan
ALTER TABLE public.operational_data ENABLE ROW LEVEL SECURITY;

-- Menghapus policy lama untuk memastikan hanya policy terbaru yang diterapkan
DROP POLICY IF EXISTS "Allow public read access" ON public.operational_data;
DROP POLICY IF EXISTS "Allow public write access" ON public.operational_data;

-- Policy 1: Mengizinkan semua orang (termasuk pengguna anonim) untuk MEMBACA data.
CREATE POLICY "Allow public read access" ON public.operational_data
FOR SELECT USING (true);

-- Policy 2: Mengizinkan semua orang untuk MENULIS (insert, update, delete) data.
-- PERINGATAN: Kebijakan ini sangat permisif dan cocok untuk demo/prototipe.
-- Untuk aplikasi produksi, Anda HARUS membatasi akses tulis ini
-- hanya untuk pengguna yang terautentikasi dan berwenang.
CREATE POLICY "Allow public write access" ON public.operational_data
FOR ALL USING (true) WITH CHECK (true);


-- -----------------------------------------------------------------
-- Tabel 2: karyawan
-- Menyimpan data karyawan perusahaan.
-- -----------------------------------------------------------------

-- Membuat tabel jika belum ada, dengan urutan kolom yang telah disesuaikan.
CREATE TABLE IF NOT EXISTS public.karyawan (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    created_at TIMESTAMPTZ DEFAULT NOW() NOT NULL,
    -- Informasi Pekerjaan
    departemen TEXT,
    divisi TEXT,
    posisi TEXT,
    status TEXT DEFAULT 'Aktif',
    tanggal_bergabung DATE,
    masa_kontrak TEXT,
    foto_url TEXT,
    -- Data Diri & Kontak
    nama TEXT NOT NULL,
    nik TEXT UNIQUE,
    alamat_ktp TEXT,
    alamat_sekarang TEXT,
    jenis_kelamin TEXT,
    tempat_lahir TEXT,
    tanggal_lahir DATE,
    agama TEXT,
    golongan_darah TEXT,
    nomor_hp TEXT,
    -- Keluarga
    status_perkawinan TEXT,
    nama_ayah TEXT,
    pekerjaan_ayah TEXT,
    nama_ibu TEXT,
    pekerjaan_ibu TEXT,
    nama_pasangan TEXT,
    nama_anak1 TEXT,
    nama_anak2 TEXT,
    nama_anak3 TEXT,
    -- Riwayat Pendidikan
    pendidikan_terakhir TEXT,
    pendidikan_sd TEXT,
    pendidikan_smp TEXT,
    pendidikan_sma TEXT,
    pendidikan_s1 TEXT,
    fakultas_s1 TEXT,
    -- Riwayat Pekerjaan Terakhir
    perusahaan_terakhir TEXT,
    alamat_perusahaan_terakhir TEXT,
    alasan_berhenti TEXT,
    lama_bekerja_terakhir TEXT,
    posisi_terakhir TEXT,
    gaji_terakhir NUMERIC,
    -- Lain-lain
    ukuran_sepatu TEXT,
    ukuran_baju TEXT,
    hobi TEXT,
    tujuan_liburan TEXT,
    moto_hari_ini TEXT
);

-- Mengganti nama kolom 'alamat' menjadi 'alamat_ktp' jika ada dan belum diganti.
-- Ini untuk menjaga kompatibilitas dengan skema tabel yang lama.
DO $$
BEGIN
   IF EXISTS(SELECT 1 FROM information_schema.columns WHERE table_name='karyawan' AND column_name='alamat')
   AND NOT EXISTS(SELECT 1 FROM information_schema.columns WHERE table_name='karyawan' AND column_name='alamat_ktp') THEN
      ALTER TABLE public.karyawan RENAME COLUMN alamat TO alamat_ktp;
   END IF;
END $$;

-- Menambahkan semua kolom ke tabel 'karyawan' jika belum ada.
-- Ini membuat skrip aman untuk dijalankan kembali pada database yang sudah ada.
ALTER TABLE public.karyawan
  -- Data Diri
  ADD COLUMN IF NOT EXISTS jenis_kelamin TEXT,
  ADD COLUMN IF NOT EXISTS tempat_lahir TEXT,
  ADD COLUMN IF NOT EXISTS tanggal_lahir DATE,
  ADD COLUMN IF NOT EXISTS agama TEXT,
  ADD COLUMN IF NOT EXISTS golongan_darah TEXT,
  ADD COLUMN IF NOT EXISTS status_perkawinan TEXT,
  ADD COLUMN IF NOT EXISTS pendidikan_terakhir TEXT,
  -- Kontak & Alamat
  ADD COLUMN IF NOT EXISTS nomor_hp TEXT,
  ADD COLUMN IF NOT EXISTS alamat_ktp TEXT,
  ADD COLUMN IF NOT EXISTS alamat_sekarang TEXT,
  -- Pekerjaan
  ADD COLUMN IF NOT EXISTS departemen TEXT,
  ADD COLUMN IF NOT EXISTS divisi TEXT,
  ADD COLUMN IF NOT EXISTS masa_kontrak TEXT,
  ADD COLUMN IF NOT EXISTS foto_url TEXT,
  -- Keluarga
  ADD COLUMN IF NOT EXISTS nama_ayah TEXT,
  ADD COLUMN IF NOT EXISTS pekerjaan_ayah TEXT,
  ADD COLUMN IF NOT EXISTS nama_ibu TEXT,
  ADD COLUMN IF NOT EXISTS pekerjaan_ibu TEXT,
  ADD COLUMN IF NOT EXISTS nama_pasangan TEXT,
  ADD COLUMN IF NOT EXISTS nama_anak1 TEXT,
  ADD COLUMN IF NOT EXISTS nama_anak2 TEXT,
  ADD COLUMN IF NOT EXISTS nama_anak3 TEXT,
  -- Riwayat Pendidikan Detail
  ADD COLUMN IF NOT EXISTS pendidikan_sd TEXT,
  ADD COLUMN IF NOT EXISTS pendidikan_smp TEXT,
  ADD COLUMN IF NOT EXISTS pendidikan_sma TEXT,
  ADD COLUMN IF NOT EXISTS pendidikan_s1 TEXT,
  ADD COLUMN IF NOT EXISTS fakultas_s1 TEXT,
  -- Riwayat Pekerjaan
  ADD COLUMN IF NOT EXISTS perusahaan_terakhir TEXT,
  ADD COLUMN IF NOT EXISTS alamat_perusahaan_terakhir TEXT,
  ADD COLUMN IF NOT EXISTS posisi_terakhir TEXT,
  ADD COLUMN IF NOT EXISTS lama_bekerja_terakhir TEXT,
  ADD COLUMN IF NOT EXISTS gaji_terakhir NUMERIC,
  ADD COLUMN IF NOT EXISTS alasan_berhenti TEXT,
  -- Informasi Lain
  ADD COLUMN IF NOT EXISTS ukuran_sepatu TEXT,
  ADD COLUMN IF NOT EXISTS ukuran_baju TEXT,
  ADD COLUMN IF NOT EXISTS hobi TEXT,
  ADD COLUMN IF NOT EXISTS tujuan_liburan TEXT,
  ADD COLUMN IF NOT EXISTS moto_hari_ini TEXT;


-- Mengaktifkan Row Level Security (RLS) untuk keamanan
ALTER TABLE public.karyawan ENABLE ROW LEVEL SECURITY;

-- Menghapus policy lama untuk memastikan hanya policy terbaru yang diterapkan
DROP POLICY IF EXISTS "Allow public read access for karyawan" ON public.karyawan;
DROP POLICY IF EXISTS "Allow public write access for karyawan" ON public.karyawan;

-- Policy 1: Mengizinkan semua orang (termasuk pengguna anonim) untuk MEMBACA data.
CREATE POLICY "Allow public read access for karyawan" ON public.karyawan
FOR SELECT USING (true);

-- Policy 2: Mengizinkan semua orang untuk MENULIS (insert, update, delete) data.
-- PERINGATAN: Sama seperti tabel operasional, batasi akses tulis ini
-- pada aplikasi produksi untuk keamanan.
CREATE POLICY "Allow public write access for karyawan" ON public.karyawan
FOR ALL USING (true) WITH CHECK (true);
```

### 4. Deployment ke Netlify (Cara yang Direkomendasikan)

Untuk menjaga keamanan kredensial Anda, jangan pernah menyimpan kunci asli Anda di dalam file `index.html` saat mengunggah ke repositori publik seperti GitHub. Gunakan fitur **Snippet Injection** dari Netlify.

1.  **Atur Variabel Lingkungan di Netlify**:
    - Pergi ke **Site settings > Build & deploy > Environment**.
    - Klik **Edit variables** dan tambahkan tiga variabel berikut:

    | Variabel             | Nilai                                                  |
    | -------------------- | ------------------------------------------------------ |
    | `API_KEY`            | Kunci API Google Gemini Anda.                          |
    | `SUPABASE_URL`       | URL Proyek Supabase Anda.                              |
    | `SUPABASE_ANON_KEY`  | Kunci `anon` (publik) Supabase Anda.                   |

2.  **Konfigurasi Snippet Injection**:
    - Pergi ke **Site settings > Build & deploy > Post processing > Snippet injection**.
    - Klik **Add snippet**.
    - Atur **Inject before `</head>`** dan tempelkan kode berikut ke dalam kotak **HTML**:

    ```html
    <script>
      window.APP_ENV = {
        API_KEY: "{{- .Env.API_KEY -}}",
        SUPABASE_URL: "{{- .Env.SUPABASE_URL -}}",
        SUPABASE_ANON_KEY: "{{- .Env.SUPABASE_ANON_KEY -}}"
      };
    </script>
    ```
    - Simpan snippet tersebut.

3.  **Deploy**: Hubungkan repositori GitHub Anda ke Netlify dan deploy. Netlify akan secara otomatis menyuntikkan kunci Anda dengan aman saat menyajikan situs Anda, tanpa menampilkannya di kode sumber Anda di GitHub.

## âš™ï¸ Konfigurasi Lainnya

Konfigurasi tambahan aplikasi (nama aplikasi, kredensial admin, dll.) dapat ditemukan di file `config.ts`.

## ğŸ“‚ Struktur Proyek

```
/
â”œâ”€â”€ components/         # Komponen React yang dapat digunakan kembali
â”‚   â”œâ”€â”€ AdminPage.tsx
â”‚   â”œâ”€â”€ AnalysisPanel.tsx
â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ services/           # Logika untuk berinteraksi dengan API eksternal
â”‚   â”œâ”€â”€ geminiService.ts
â”‚   â””â”€â”€ supabaseClient.ts # Konfigurasi Supabase client
â”œâ”€â”€ constants.ts        # Fungsi kalkulasi KPI
â”œâ”€â”€ config.ts           # File konfigurasi utama aplikasi
â”œâ”€â”€ types.ts            # Definisi tipe TypeScript
â”œâ”€â”€ App.tsx             # Komponen utama aplikasi
â”œâ”€â”€ index.tsx           # Titik masuk aplikasi React
â””â”€â”€ index.html          # File HTML utama
```